"use strict";function repeatWhen(t){return this.lift(new RepeatWhenOperator(t,this))}var __extends=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)},Subject_1=require("../Subject"),tryCatch_1=require("../util/tryCatch"),errorObject_1=require("../util/errorObject"),OuterSubscriber_1=require("../OuterSubscriber"),subscribeToResult_1=require("../util/subscribeToResult");exports.repeatWhen=repeatWhen;var RepeatWhenOperator=function(){function t(t,i){this.notifier=t,this.source=i}return t.prototype.call=function(t,i){return i._subscribe(new RepeatWhenSubscriber(t,this.notifier,this.source))},t}(),RepeatWhenSubscriber=function(t){function i(i,e,r){t.call(this,i),this.notifier=e,this.source=r}return __extends(i,t),i.prototype.complete=function(){if(!this.isStopped){var i=this.notifications,e=this.retries,r=this.retriesSubscription;if(e)this.notifications=null,this.retriesSubscription=null;else{if(i=new Subject_1.Subject,e=tryCatch_1.tryCatch(this.notifier)(i),e===errorObject_1.errorObject)return t.prototype.complete.call(this);r=subscribeToResult_1.subscribeToResult(this,e)}this.unsubscribe(),this.closed=!1,this.notifications=i,this.retries=e,this.retriesSubscription=r,i.next()}},i.prototype._unsubscribe=function(){var t=this,i=t.notifications,e=t.retriesSubscription;i&&(i.unsubscribe(),this.notifications=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},i.prototype.notifyNext=function(t,i,e,r,s){var n=this,o=n.notifications,u=n.retries,c=n.retriesSubscription;this.notifications=null,this.retries=null,this.retriesSubscription=null,this.unsubscribe(),this.isStopped=!1,this.closed=!1,this.notifications=o,this.retries=u,this.retriesSubscription=c,this.source.subscribe(this)},i}(OuterSubscriber_1.OuterSubscriber);
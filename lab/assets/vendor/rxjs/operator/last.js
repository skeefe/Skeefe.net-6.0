"use strict";function last(t,e,r){return this.lift(new LastOperator(t,e,r,this))}var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Subscriber_1=require("../Subscriber"),EmptyError_1=require("../util/EmptyError");exports.last=last;var LastOperator=function(){function t(t,e,r,s){this.predicate=t,this.resultSelector=e,this.defaultValue=r,this.source=s}return t.prototype.call=function(t,e){return e._subscribe(new LastSubscriber(t,this.predicate,this.resultSelector,this.defaultValue,this.source))},t}(),LastSubscriber=function(t){function e(e,r,s,i,o){t.call(this,e),this.predicate=r,this.resultSelector=s,this.defaultValue=i,this.source=o,this.hasValue=!1,this.index=0,"undefined"!=typeof i&&(this.lastValue=i,this.hasValue=!0)}return __extends(e,t),e.prototype._next=function(t){var e=this.index++;if(this.predicate)this._tryPredicate(t,e);else{if(this.resultSelector)return void this._tryResultSelector(t,e);this.lastValue=t,this.hasValue=!0}},e.prototype._tryPredicate=function(t,e){var r;try{r=this.predicate(t,e,this.source)}catch(t){return void this.destination.error(t)}if(r){if(this.resultSelector)return void this._tryResultSelector(t,e);this.lastValue=t,this.hasValue=!0}},e.prototype._tryResultSelector=function(t,e){var r;try{r=this.resultSelector(t,e)}catch(t){return void this.destination.error(t)}this.lastValue=r,this.hasValue=!0},e.prototype._complete=function(){var t=this.destination;this.hasValue?(t.next(this.lastValue),t.complete()):t.error(new EmptyError_1.EmptyError)},e}(Subscriber_1.Subscriber);
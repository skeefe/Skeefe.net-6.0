"use strict";var __extends=this&&this.__extends||function(r,t){function e(){this.constructor=r}for(var s in t)t.hasOwnProperty(s)&&(r[s]=t[s]);r.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)},Observable_1=require("./Observable"),Subscriber_1=require("./Subscriber"),Subscription_1=require("./Subscription"),ObjectUnsubscribedError_1=require("./util/ObjectUnsubscribedError"),SubjectSubscription_1=require("./SubjectSubscription"),rxSubscriber_1=require("./symbol/rxSubscriber"),SubjectSubscriber=function(r){function t(t){r.call(this,t),this.destination=t}return __extends(t,r),t}(Subscriber_1.Subscriber);exports.SubjectSubscriber=SubjectSubscriber;var Subject=function(r){function t(){r.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return __extends(t,r),t.prototype[rxSubscriber_1.$$rxSubscriber]=function(){return new SubjectSubscriber(this)},t.prototype.lift=function(r){var t=new AnonymousSubject(this,this);return t.operator=r,t},t.prototype.next=function(r){if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError;if(!this.isStopped)for(var t=this.observers,e=t.length,s=t.slice(),i=0;i<e;i++)s[i].next(r)},t.prototype.error=function(r){if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=r,this.isStopped=!0;for(var t=this.observers,e=t.length,s=t.slice(),i=0;i<e;i++)s[i].error(r);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError;this.isStopped=!0;for(var r=this.observers,t=r.length,e=r.slice(),s=0;s<t;s++)e[s].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._subscribe=function(r){if(this.closed)throw new ObjectUnsubscribedError_1.ObjectUnsubscribedError;return this.hasError?(r.error(this.thrownError),Subscription_1.Subscription.EMPTY):this.isStopped?(r.complete(),Subscription_1.Subscription.EMPTY):(this.observers.push(r),new SubjectSubscription_1.SubjectSubscription(this,r))},t.prototype.asObservable=function(){var r=new Observable_1.Observable;return r.source=this,r},t.create=function(r,t){return new AnonymousSubject(r,t)},t}(Observable_1.Observable);exports.Subject=Subject;var AnonymousSubject=function(r){function t(t,e){r.call(this),this.destination=t,this.source=e}return __extends(t,r),t.prototype.next=function(r){var t=this.destination;t&&t.next&&t.next(r)},t.prototype.error=function(r){var t=this.destination;t&&t.error&&this.destination.error(r)},t.prototype.complete=function(){var r=this.destination;r&&r.complete&&this.destination.complete()},t.prototype._subscribe=function(r){var t=this.source;return t?this.source.subscribe(r):Subscription_1.Subscription.EMPTY},t}(Subject);exports.AnonymousSubject=AnonymousSubject;
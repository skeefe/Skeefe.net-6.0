"use strict";function dispatchNext(e){var t=e.value,r=e.subscriber;r.closed||(r.next(t),r.complete())}function dispatchError(e){var t=e.err,r=e.subscriber;r.closed||r.error(t)}var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},root_1=require("../util/root"),Observable_1=require("../Observable"),PromiseObservable=function(e){function t(t,r){e.call(this),this.promise=t,this.scheduler=r}return __extends(t,e),t.create=function(e,r){return new t(e,r)},t.prototype._subscribe=function(e){var t=this,r=this.promise,s=this.scheduler;if(null==s)this._isScalar?e.closed||(e.next(this.value),e.complete()):r.then(function(r){t.value=r,t._isScalar=!0,e.closed||(e.next(r),e.complete())},function(t){e.closed||e.error(t)}).then(null,function(e){root_1.root.setTimeout(function(){throw e})});else if(this._isScalar){if(!e.closed)return s.schedule(dispatchNext,0,{value:this.value,subscriber:e})}else r.then(function(r){t.value=r,t._isScalar=!0,e.closed||e.add(s.schedule(dispatchNext,0,{value:r,subscriber:e}))},function(t){e.closed||e.add(s.schedule(dispatchError,0,{err:t,subscriber:e}))}).then(null,function(e){root_1.root.setTimeout(function(){throw e})})},t}(Observable_1.Observable);exports.PromiseObservable=PromiseObservable;
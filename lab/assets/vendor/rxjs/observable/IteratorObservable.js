"use strict";function getIterator(t){var r=t[iterator_1.$$iterator];if(!r&&"string"==typeof t)return new StringIterator(t);if(!r&&void 0!==t.length)return new ArrayIterator(t);if(!r)throw new TypeError("object is not iterable");return t[iterator_1.$$iterator]()}function toLength(t){var r=+t.length;return isNaN(r)?0:0!==r&&numberIsFinite(r)?(r=sign(r)*Math.floor(Math.abs(r)),r<=0?0:r>maxSafeInteger?maxSafeInteger:r):r}function numberIsFinite(t){return"number"==typeof t&&root_1.root.isFinite(t)}function sign(t){var r=+t;return 0===r?r:isNaN(r)?r:r<0?-1:1}var __extends=this&&this.__extends||function(t,r){function e(){this.constructor=t}for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)},root_1=require("../util/root"),Observable_1=require("../Observable"),iterator_1=require("../symbol/iterator"),IteratorObservable=function(t){function r(r,e){if(t.call(this),this.scheduler=e,null==r)throw new Error("iterator cannot be null.");this.iterator=getIterator(r)}return __extends(r,t),r.create=function(t,e){return new r(t,e)},r.dispatch=function(t){var r=t.index,e=t.hasError,i=t.iterator,n=t.subscriber;if(e)return void n.error(t.error);var o=i.next();return o.done?void n.complete():(n.next(o.value),t.index=r+1,void(n.closed||this.schedule(t)))},r.prototype._subscribe=function(t){var e=0,i=this,n=i.iterator,o=i.scheduler;if(o)return o.schedule(r.dispatch,0,{index:e,iterator:n,subscriber:t});for(;;){var a=n.next();if(a.done){t.complete();break}if(t.next(a.value),t.closed)break}},r}(Observable_1.Observable);exports.IteratorObservable=IteratorObservable;var StringIterator=function(){function t(t,r,e){void 0===r&&(r=0),void 0===e&&(e=t.length),this.str=t,this.idx=r,this.len=e}return t.prototype[iterator_1.$$iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.str.charAt(this.idx++)}:{done:!0,value:void 0}},t}(),ArrayIterator=function(){function t(t,r,e){void 0===r&&(r=0),void 0===e&&(e=toLength(t)),this.arr=t,this.idx=r,this.len=e}return t.prototype[iterator_1.$$iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.arr[this.idx++]}:{done:!0,value:void 0}},t}(),maxSafeInteger=Math.pow(2,53)-1;